---
title: "Assignment_2"
output:
  html_document:
    df_print: paged
  pdf_document: default
  word_document: default
  html_notebook: default
---




```{r}
UniversalBank <- read.csv("C:/Users/Dell/Desktop/UniversalBank.csv")
View(UniversalBank)

summary(UniversalBank)
```
# NULL Variables

```{r}
UniversalBank$ID <- NULL
UniversalBank$ZIP.Code <- NULL
UniversalBank$Personal.Loan = as.factor(UniversalBank$Personal.Loan)
summary(UniversalBank)
```


   
# Normalizing the data
   
```{r}

 library(caret)
 library(class)


Norm_model <- preProcess(UniversalBank[,-8], method = c("center", "scale"))
UniversalBank_norm=predict(Norm_model,UniversalBank[,-8])
summary(UniversalBank_norm)

```
# adding back the target variable

```{r}
UniversalBank_norm$Personal.Loan=UniversalBank$Personal.Loan
```

# dividing the data into train and validation
```{r}
Train_Index = createDataPartition(UniversalBank$Personal.Loan,p=0.6, list=FALSE) 
Train.df=UniversalBank_norm[Train_Index,]
Validation.df=UniversalBank_norm[-Train_Index,]
```
 
#  Task 1

# Use the train set and knn method with k=1 to predict if a new customer will accept a loan offer

```{r}
To_Predict=data.frame(Age=40, Experience=10,Income=84,Family=2,
                      CCAvg=2,Education=1, Mortgage=0, 
                      Securities.Account=0,CD.Account=0,Online=1,CreditCard=1 )
print(To_Predict)
```

#applying the normalization


```{r}
To_Predict_norm <- predict(Norm_model,To_Predict)
print(To_Predict_norm)

```

#Knn Prediction (first 7 columns are input variables and Personal loan is the target variable)

```{r}
Prediction <-knn(train=Train.df[,1:7], 
             test=To_Predict_norm[,1:7],
             cl=Train.df$Personal.Loan,
             k=1)
print(Prediction)
```

* As output is zero new customer will not accept a loan offer

# Task 2
# crossvalidation for overfitting

```{r}
set.seed(123)
fitControl <- trainControl(method = "repeatedcv",number = 3,repeats = 2)
  
searchGrid = expand.grid(k = 1:10)

Knn.model=train(Personal.Loan~.,
                data=Train.df,
                method='knn',
                tuneGrid=searchGrid,
                trControl = fitControl)
```

#Task 3

# confusion matrix for the validation data that results from using the best k

```{r}
To_Predict=data.frame(Age=40, Experience=10,Income=84,Family=2,
                      CCAvg=2,Education=1, Mortgage=0, 
                      Securities.Account=0,CD.Account=0,Online=1,CreditCard=1 )

predictions<-predict(Knn.model,Validation.df)
confusionMatrix(predictions,Validation.df$Personal.Loan)
```

# considering some other attributes

```{r}


To_Predict=data.frame(Age=40, Experience=10,Income=84,Family=2,
                      CCAvg=2,Education=1, Mortgage=0, 
                      Securities.Account=0,CD.Account=0,Online=1,CreditCard=1 )

To_Predict_norm=predict(Norm_model,To_Predict)
predict(Knn.model,To_Predict_norm)
```
